(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{702:function(e,t,r){Promise.resolve().then(r.bind(r,5775)),Promise.resolve().then(r.bind(r,1199))},1199:function(e,t,r){"use strict";r.d(t,{WeatherAdaptiveBackground:function(){return s}});var o=r(7437),a=r(2265);let n={id:"default",backgroundColor:"#0f172a",overlayColor:"rgba(15, 23, 42, 0.55)",image:"/backgrounds/clear-night.svg",textColor:"#f8fafc",description:"Aguardando dados meteorol\xf3gicos"},l={"clear-day":{id:"clear-day",backgroundColor:"#38bdf8",overlayColor:"rgba(14, 116, 144, 0.45)",image:"/backgrounds/clear-day.svg",textColor:"#082f49",description:"C\xe9u limpo"},"clear-night":{id:"clear-night",backgroundColor:"#111827",overlayColor:"rgba(15, 23, 42, 0.65)",image:"/backgrounds/clear-night.svg",textColor:"#e2e8f0",description:"Noite limpa"},cloudy:{id:"cloudy",backgroundColor:"#cbd5f5",overlayColor:"rgba(30, 64, 175, 0.35)",image:"/backgrounds/cloudy.svg",textColor:"#0f172a",description:"Nublado"},fog:{id:"fog",backgroundColor:"#cbd5f5",overlayColor:"rgba(71, 85, 105, 0.35)",image:"/backgrounds/fog.svg",textColor:"#0f172a",description:"Neblina"},rainy:{id:"rainy",backgroundColor:"#1e293b",overlayColor:"rgba(30, 64, 175, 0.55)",image:"/backgrounds/rainy.svg",textColor:"#e2e8f0",description:"Chuva"},snowy:{id:"snowy",backgroundColor:"#f8fafc",overlayColor:"rgba(59, 130, 246, 0.35)",image:"/backgrounds/snowy.svg",textColor:"#0f172a",description:"Neve"},storm:{id:"storm",backgroundColor:"#020617",overlayColor:"rgba(147, 197, 253, 0.25)",image:"/backgrounds/storm.svg",textColor:"#e0f2fe",description:"Tempestade"}};async function i(e,t){try{var r,o;let a=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(e,"&lon=").concat(t),{headers:{"User-Agent":"FlowGuiltPomodoro/1.0"}});if(!a.ok)throw Error("Falha ao buscar endere\xe7o");let n=await a.json(),l=n.address;if(!l)return null!==(r=n.display_name)&&void 0!==r?r:"Localiza\xe7\xe3o desconhecida";let i=l.city||l.town||l.village||l.municipality||l.state,s=l.country;if(i&&s)return"".concat(i,", ").concat(s);return null!==(o=n.display_name)&&void 0!==o?o:"Localiza\xe7\xe3o detectada"}catch(e){return console.error("Erro ao resolver cidade",e),"Localiza\xe7\xe3o desconhecida"}}function s(e){let{children:t}=e,[r,s]=(0,a.useState)(n),[c,d]=(0,a.useState)(null),[u,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;if(!("geolocation"in navigator)){f("Geolocaliza\xe7\xe3o n\xe3o suportada no dispositivo");return}return navigator.geolocation.getCurrentPosition(async t=>{try{var r;let{latitude:o,longitude:a}=t.coords,n=await fetch("https://api.open-meteo.com/v1/forecast?latitude=".concat(o,"&longitude=").concat(a,"&current_weather=true&timezone=auto"));if(!n.ok)throw Error("Falha ao consultar previs\xe3o do tempo");let c=await n.json();if(!c.current_weather)throw Error("Resposta meteorol\xf3gica incompleta");let{temperature:u,weathercode:m,is_day:p}=c.current_weather,x=(r=1===p,[0].includes(m)?r?l["clear-day"]:l["clear-night"]:[1,2,3].includes(m)?r?l.cloudy:l["clear-night"]:[45,48].includes(m)?l.fog:[51,53,55,56,57,61,63,65,66,67,80,81,82].includes(m)?l.rainy:[71,73,75,77,85,86].includes(m)?l.snowy:[95,96,99].includes(m)?l.storm:r?l["clear-day"]:l["clear-night"]),[h]=await Promise.all([i(o,a)]);e||(s(x),d({cityLabel:h,temperature:u,description:0===m?"C\xe9u limpo":1===m?"Predominantemente limpo":2===m?"Parcialmente nublado":3===m?"Nublado":[45,48].includes(m)?"Neblina":[51,53,55].includes(m)?"Garoa":[56,57].includes(m)?"Garoa congelante":[61,63,65].includes(m)?"Chuva":[66,67].includes(m)?"Chuva congelante":[71,73,75,77,85,86].includes(m)?"Neve":[80,81,82].includes(m)?"Aguaceiros":[95,96,99].includes(m)?"Tempestade":"Condi\xe7\xe3o desconhecida"}),f(null))}catch(t){console.error(t),e||(f("N\xe3o foi poss\xedvel obter o clima da sua regi\xe3o"),s(n))}},e=>{console.error(e),f("Permita o acesso \xe0 localiza\xe7\xe3o para personalizar o tema")},{enableHighAccuracy:!1,timeout:1e4,maximumAge:36e5}),()=>{e=!0}},[]);let m=(0,a.useMemo)(()=>({backgroundColor:r.overlayColor}),[r.overlayColor]),p=(0,a.useMemo)(()=>({backgroundColor:r.backgroundColor,backgroundImage:"url(".concat(r.image,")"),backgroundPosition:"center",backgroundSize:"cover",color:r.textColor}),[r.backgroundColor,r.image,r.textColor]);return(0,o.jsx)("div",{className:"min-h-screen w-full bg-slate-950 text-slate-100 transition-colors duration-700 ease-out",style:p,children:(0,o.jsxs)("div",{className:"relative min-h-screen w-full",children:[(0,o.jsx)("div",{className:"absolute inset-0 pointer-events-none",style:m,"aria-hidden":!0}),(0,o.jsxs)("div",{className:"relative z-10 flex min-h-screen flex-col",children:[(0,o.jsx)("div",{className:"flex items-start justify-end px-6 pt-6",children:(0,o.jsx)("div",{className:"max-w-xs rounded-2xl border border-white/10 bg-black/30 px-4 py-3 text-right text-sm backdrop-blur-xl",style:{color:r.textColor},children:c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{className:"font-semibold",children:c.cityLabel}),(0,o.jsxs)("p",{children:[c.description,null!=c.temperature&&(0,o.jsxs)("span",{className:"ml-2 font-medium",children:[c.temperature.toFixed(1),"\xb0C"]})]})]}):u?(0,o.jsx)("p",{className:"font-medium",children:u}):(0,o.jsx)("p",{className:"font-medium",children:"Personalizando experi\xeancia..."})})}),(0,o.jsx)("main",{className:"flex flex-1 items-center justify-center p-6",children:t})]})]})})}},5775:function(e,t,r){"use strict";r.d(t,{BackgroundPlaylistPopover:function(){return d}});var o=r(7437),a=r(2265);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let o=[];return t.forEach(e=>(function e(t,r){if(t){if("string"==typeof t||"number"==typeof t){r.push(String(t));return}if(Array.isArray(t)){t.forEach(t=>e(t,r));return}Object.entries(t).forEach(e=>{let[t,o]=e;o&&r.push(t)})}})(e,o)),o.join(" ")}let l={primary:"bg-[#1DB954] text-black shadow-[0_0_20px_rgba(29,185,84,0.2)] hover:brightness-110 focus-visible:ring-[#1DB954]",secondary:"bg-[#232323] text-zinc-200 hover:brightness-110 focus-visible:ring-[#6C3BF4]"},i=a.forwardRef(function(e,t){var r;let{variant:a="primary",className:i,disabled:s,...c}=e,d=null!==(r=l[a])&&void 0!==r?r:l.primary;return(0,o.jsx)("button",{ref:t,"data-variant":a,className:n("inline-flex items-center justify-center rounded-md px-4 py-2 text-sm font-medium transition focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-transparent",s?"cursor-not-allowed opacity-70":void 0,d,i),disabled:s,...c})}),s=[{id:"serotonin",name:"Serotonin",description:"Para focar com g\xe1s total.",spotifyId:"4dx7CqzVnWkTvTox9poIYF"},{id:"brazilian-lofi",name:"Brazilian Lofi",description:"Lofi nacional com groove leve e constante.",spotifyId:"7K3scENpOi7ZPZUHfnfic3"},{id:"eletronics-lofi",name:"Eletronics",description:"Ser constante e flu\xeddo.",spotifyId:"4rCCdVVzrdSOoyvBXGdnGL"}];function c(){let[e,t]=(0,a.useState)({spotifyId:s[0].spotifyId,label:s[0].name,isCustom:!1}),[r,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(null),[u,f]=(0,a.useState)(!1),[m,p]=(0,a.useState)(70),[x,h]=(0,a.useState)(!1),[v,g]=(0,a.useState)(!1),y=function(){let[e,t]=(0,a.useState)(()=>{var e;return null!==(e=window.SpotifyIframeApi)&&void 0!==e?e:null});return(0,a.useEffect)(()=>{if(e)return;let r=window.SpotifyIframeApi;if(r){t(r);return}let o=document.createElement("script");o.src="https://open.spotify.com/embed/iframe-api/v1",o.async=!0,document.body.appendChild(o);let a=e=>{window.SpotifyIframeApi=e,t(e)};return window.onSpotifyIframeApiReady=a,()=>{window.onSpotifyIframeApiReady===a&&(window.onSpotifyIframeApiReady=void 0)}},[e]),e}(),b=(0,a.useRef)(null),w=(0,a.useRef)(null),[C,k]=(0,a.useState)(!1),j=(0,a.useRef)(!1),N=(0,a.useRef)(!1),E=(0,a.useRef)(null),S=(0,a.useCallback)(async t=>{let r="spotify:playlist:".concat(e.spotifyId),o=await (async()=>{if("function"!=typeof t.getCurrentState)return null;try{let e=await t.getCurrentState(),r=function(e){if(!e||"object"!=typeof e)return null;for(let r of[["context","metadata","current_context","metadata","length"],["context","metadata","length"],["metadata","current_context","metadata","length"],["metadata","context","metadata","length"],["metadata","track_count"]]){var t;let o=e;for(let e of r){if(!o||"object"!=typeof o){o=void 0;break}o=o[e]}if("number"==typeof(t=o)&&Number.isFinite(t)&&t>0)return o}let r=e.metadata;if(!r||"object"!=typeof r)return null;let o=Array.isArray(r.next_tracks)?r.next_tracks.length:0,a=Array.isArray(r.previous_tracks)?r.previous_tracks.length:0,n=o+a+(r.current_track?1:0);return n>0?n:null}(e);return r&&r>1?r:null}catch(e){return null}})(),a=Math.floor(Math.random()*Math.max(1,null!=o?o:20));for(let e of Array.from(new Set([a,a>0?Math.floor(a/2):0,0]).values()))try{let o=t.play({uri:r,index:{position:e}});return o&&"function"==typeof o.then&&await o,!0}catch(e){}return!1},[e.spotifyId]),z=(0,a.useCallback)(t=>{var r,o;let a=null!=t?t:w.current;if(!a)return;let n=j.current,l=e.spotifyId;if(!n){N.current=!1,E.current=null,null===(o=a.pause)||void 0===o||o.call(a);return}let i=N.current,s=E.current!==l;if(N.current=!0,!i||s){(async()=>{var e,t;let r=await S(a);if(!j.current){null===(e=a.pause)||void 0===e||e.call(a);return}r||null===(t=a.play)||void 0===t||t.call(a),E.current=l})();return}null===(r=a.play)||void 0===r||r.call(a)},[e.spotifyId,S]);(0,a.useEffect)(()=>{let e=()=>{j.current=!0,z()},t=()=>{j.current=!1,z()};return window.addEventListener("flowguilt:pomodoro-timer-start",e),window.addEventListener("flowguilt:pomodoro-timer-pause",t),()=>{window.removeEventListener("flowguilt:pomodoro-timer-start",e),window.removeEventListener("flowguilt:pomodoro-timer-pause",t)}},[]);let A=e=>{t({spotifyId:e.spotifyId,label:e.name,isCustom:!1}),d(null)};(0,a.useEffect)(()=>{if(!y||w.current||!b.current)return;let t=!1;return y.createController(b.current,{uri:"spotify:playlist:".concat(e.spotifyId),width:"100%",height:"232",theme:"dark"},e=>{var r,o;if(t){null===(r=e.destroy)||void 0===r||r.call(e);return}w.current=e;let a="function"==typeof e.setVolume;g(a),a?null===(o=e.setVolume)||void 0===o||o.call(e,m/100):h(!1),z(e),k(!0)}),()=>{var e,r;t=!0,null===(r=w.current)||void 0===r||null===(e=r.destroy)||void 0===e||e.call(r),w.current=null,k(!1),g(!1),h(!1),b.current&&(b.current.innerHTML="")}},[y]),(0,a.useEffect)(()=>{let t=w.current;if(!t)return;let r=t.loadUri("spotify:playlist:".concat(e.spotifyId));r&&"function"==typeof r.then?r.then(()=>{z(w.current)}):z(t)},[e.spotifyId]),(0,a.useEffect)(()=>{let e=w.current;(null==e?void 0:e.setVolume)&&e.setVolume(m/100)},[m]);let L=e=>{p(Math.min(100,Math.max(0,e)))};return(0,o.jsxs)("section",{className:"flex flex-col gap-4 rounded-xl border border-white/5 bg-[#161616]/90 p-4 shadow-xl",children:[(0,o.jsxs)("header",{className:"flex flex-col gap-1",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-zinc-100",children:"Ambiente sonoro de fundo"}),(0,o.jsx)("p",{className:"text-sm text-zinc-400",children:"Escolha uma das playlists sugeridas ou cole o link da sua playlist do Spotify. Sempre que voc\xea alternar, apenas a playlist selecionada permanecer\xe1 tocando."})]}),(0,o.jsx)("div",{className:"grid gap-3 sm:grid-cols-2",children:s.map(t=>{let r=!e.isCustom&&e.spotifyId===t.spotifyId;return(0,o.jsxs)("div",{className:n("flex flex-col justify-between gap-3 rounded-lg border border-white/10 bg-black/40 p-3 transition",r?"border-[#1DB954]/60 shadow-[0_0_18px_rgba(29,185,84,0.25)]":"hover:border-white/20"),children:[(0,o.jsxs)("div",{className:"space-y-1",children:[(0,o.jsx)("p",{className:"text-sm font-semibold text-zinc-100",children:t.name}),(0,o.jsx)("p",{className:"text-xs text-zinc-400",children:t.description})]}),(0,o.jsx)(i,{type:"button",variant:r?"primary":"secondary",className:"text-xs",onClick:()=>A(t),"aria-pressed":r,children:r?"Selecionada":"Ouvir playlist"})]},t.id)})}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault();let o=function(e){let t=e.trim();if(!t)return null;let r=t.match(/playlist\/(\w+)(?:\?|$)/);return r&&r[1]?r[1]:/^[a-zA-Z0-9]+$/.test(t)?t:null}(r);if(!o){d("N\xe3o foi poss\xedvel reconhecer esse link de playlist.");return}t({spotifyId:o,label:"Sua playlist",isCustom:!0}),f(!0),d(null)},className:"flex flex-col gap-3 rounded-lg border border-dashed border-white/10 bg-black/40 p-3 sm:flex-row sm:items-center",children:[(0,o.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,o.jsx)("label",{htmlFor:"customPlaylist",className:"text-xs font-medium uppercase tracking-[0.16em] text-zinc-400",children:"Adicionar playlist personalizada"}),(0,o.jsx)("input",{id:"customPlaylist",name:"customPlaylist",value:r,onChange:e=>l(e.target.value),placeholder:"Cole aqui o link da playlist do Spotify",className:"w-full rounded-md border border-white/10 bg-black/60 px-3 py-2 text-sm text-zinc-100 placeholder:text-zinc-500 focus:border-[#6C3BF4] focus:outline-none focus:ring-2 focus:ring-[#6C3BF4]/30"}),c?(0,o.jsx)("p",{className:"text-xs text-amber-300",children:c}):u?(0,o.jsx)("p",{className:"text-xs text-emerald-300",children:"Playlist personalizada pronta para tocar."}):null]}),(0,o.jsx)(i,{type:"submit",className:"whitespace-nowrap text-xs",children:"Usar minha playlist"})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("p",{className:"text-xs uppercase tracking-[0.18em] text-zinc-400",children:"Reprodu\xe7\xe3o atual"}),(0,o.jsx)("div",{className:"overflow-hidden rounded-xl border border-white/10 bg-black/60 shadow-inner",children:(0,o.jsx)("div",{ref:b,className:n("h-[232px] w-full",C?void 0:"grid place-items-center text-sm text-zinc-400"),children:!C&&(0,o.jsx)("p",{children:"Carregando player do Spotify..."})})}),(0,o.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border border-white/10 bg-black/40 p-3",children:[(0,o.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,o.jsx)("p",{className:"text-xs text-zinc-300",children:"Controle de volume"}),(0,o.jsx)(i,{type:"button",variant:"secondary",className:"text-xs",onClick:()=>h(e=>!e),"aria-expanded":x,disabled:!v,children:v?x?"Ocultar medidor":"Medir volume":"Indispon\xedvel"})]}),v?x&&(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("label",{htmlFor:"playlistVolume",className:"text-xs uppercase tracking-[0.14em] text-zinc-400",children:["Volume atual: ",m,"%"]}),(0,o.jsx)("input",{id:"playlistVolume",type:"range",min:0,max:100,step:1,value:m,onChange:e=>L(Number(e.target.value)),className:"accent-[#1DB954]"})]}):(0,o.jsx)("p",{className:"text-xs text-amber-300",children:"Ajuste o volume diretamente no player do Spotify."})]}),(0,o.jsx)("p",{className:"text-xs text-zinc-400",children:e.isCustom?"Tocando a sua playlist do Spotify.":"Tocando: ".concat(e.label,".")})]})]})}function d(e){let{initialOpen:t=!1,showTrigger:r=!0,dismissible:l=!0}=e,[s,d]=(0,a.useState)(t),u=(0,a.useRef)(null),f=(0,a.useRef)(null),[m,p]=(0,a.useState)({top:120,left:120}),[x,h]=(0,a.useState)(!1),v=(0,a.useRef)(!1),g=(0,a.useRef)(null),y=(0,a.useCallback)(e=>{var t,r;let o=f.current,a=null!==(t=null==o?void 0:o.offsetWidth)&&void 0!==t?t:0,n=null!==(r=null==o?void 0:o.offsetHeight)&&void 0!==r?r:0,l=Math.max(16,window.innerWidth-a-16),i=Math.max(16,window.innerHeight-n-16);return{top:Math.min(Math.max(e.top,16),i),left:Math.min(Math.max(e.left,16),l)}},[]),b=(0,a.useCallback)(e=>{p(t=>{let r=y(e);return t.top===r.top&&t.left===r.left?t:r})},[y]),w=(0,a.useCallback)(e=>{let t=g.current;if(!t)return;let r=e.clientX-t.startX,o=e.clientY-t.startY;b({left:t.startLeft+r,top:t.startTop+o})},[b]),C=(0,a.useCallback)(()=>{g.current&&(g.current=null,v.current=!0,h(!1),window.removeEventListener("pointermove",w),window.removeEventListener("pointerup",C))},[w]),k=(0,a.useCallback)(e=>{f.current&&(e.preventDefault(),e.stopPropagation(),g.current={startX:e.clientX,startY:e.clientY,startLeft:m.left,startTop:m.top},h(!0),window.addEventListener("pointermove",w),window.addEventListener("pointerup",C))},[w,C,m.left,m.top]);return(0,a.useEffect)(()=>()=>{window.removeEventListener("pointermove",w),window.removeEventListener("pointerup",C)},[w,C]),(0,a.useEffect)(()=>{d(t)},[t]),(0,a.useEffect)(()=>{if(!s)return;let e=e=>{var t,o;let a=e.target;!(!a||(null===(t=f.current)||void 0===t?void 0:t.contains(a))||r&&(null===(o=u.current)||void 0===o?void 0:o.contains(a)))&&l&&d(!1)},t=e=>{"Escape"===e.key&&l&&d(!1)};l&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),document.addEventListener("keydown",t));let o=window.requestAnimationFrame(()=>{if(f.current){if(!v.current){if(r&&u.current){let e=u.current.getBoundingClientRect(),t=f.current.offsetWidth,r=e.left+e.width/2-t/2;b({top:e.bottom+12,left:r});return}let e=f.current.offsetWidth,t=f.current.offsetHeight;b({top:window.innerHeight/2-t/2,left:window.innerWidth/2-e/2});return}p(e=>{let t=y(e);return t.top===e.top&&t.left===e.left?e:t})}}),a=()=>{p(e=>{let t=y(e);return t.top===e.top&&t.left===e.left?e:t})};return window.addEventListener("resize",a),()=>{l&&(document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e),document.removeEventListener("keydown",t)),window.removeEventListener("resize",a),window.cancelAnimationFrame(o)}},[y,l,s,r,b]),(0,o.jsxs)("div",{className:"relative flex flex-col items-center",children:[r&&(0,o.jsx)(i,{ref:u,type:"button",variant:"secondary",onClick:()=>d(e=>!e),"aria-haspopup":"dialog","aria-expanded":s,children:"Ambiente sonoro"}),(0,o.jsx)("div",{ref:f,className:n("fixed z-50 w-full max-w-xl transition-opacity duration-150 ease-out",s?"pointer-events-auto opacity-100":"pointer-events-none opacity-0"),style:{top:m.top,left:m.left},role:"dialog","aria-modal":"false","aria-label":"Configura\xe7\xf5es do ambiente sonoro de fundo","aria-hidden":!s,children:(0,o.jsxs)("div",{className:"overflow-hidden rounded-xl border border-white/5 bg-[#161616]/90 shadow-2xl backdrop-blur",children:[(0,o.jsxs)("div",{onPointerDown:k,className:n("flex cursor-move items-center justify-center gap-2 border-b border-white/5 bg-black/20 px-4 py-2 text-xs font-medium uppercase tracking-[0.2em] text-zinc-400",x?"cursor-grabbing select-none":void 0),children:[(0,o.jsx)("span",{"aria-hidden":"true",children:"⠿"}),(0,o.jsx)("span",{children:"Arraste para mover"})]}),(0,o.jsx)(c,{})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=702)}),_N_E=e.O()}]);